<!--
Version 1.2

History:
 v1.2 2024-06-01
   - Added Battery SVG objects and code (GizMoCuz)
 
 v1.1 2024-05-31
  - Changed deprecated api url and corrected it to "/json.htm?type=command&param=getdevices&rid="
  - idGas en idSolar can be set to -1 when not used.

 v1.0 2024-05-18
   - First version. (MeneerKees)
-->
<style type="text/css">
#boxmain {
	background: #ffffff;
	border-color: #7c0202;
	border-radius: 2vw;
	border-style: solid;
	border-width: 0.5vw;
	color: #000000;
	text-align: center;
	width: 95vw; 
	height: calc(100vh - 130px);
	margin: 0 auto auto auto;
	text-align: center;	
}

#SolarToNet-flow, #SolarToHome-flow, #BattNet-flow, #BattHome-flow, #NetToHome-flow, #SolarToBatt-flow {
	stroke-dasharray: 1; 
	stroke-dashoffset: 10;
}

@keyframes flow {
	100% {
		stroke-dashoffset: 0;
	}
}
</style>

<div id="boxmain">
<?xml version="1.0" encoding="utf-8"?>
<svg width="100%" height="100%" version="1.1" viewBox="0 0 60 60" xmlns="http://www.w3.org/2000/svg">
  <g id="groupNet">
    <rect id="rectNet" x="3" y="22" width="14" height="14" ry="7" fill="none" stroke="#00c6da" stroke-linecap="round" stroke-width=".3"/>
    <path id="pathIconNet" d="m9.1 24-0.45-0.18 0.32-0.51h2.1l0.32 0.51-0.45 0.18-0.18-0.29h-1.5l-0.18 0.29m2.6 0.51h-1.1l-0.2-0.6h-0.66l-0.2 0.6h-1.1l-0.32 0.51 0.45 0.18 0.18-0.29h2.7l0.18 0.29 0.45-0.18-0.32-0.51m-0.22 2.8h-0.52l-0.061-0.18-0.88-1-0.88 1-0.058 0.18h-0.52l0.73-2.2h0.52l-0.091 0.27 0.3 0.35 0.29-0.35-0.089-0.27h0.52l0.73 2.2m-1.6-1.4-0.23-0.27-0.3 0.9 0.53-0.63m0.83 0.62-0.3-0.9-0.23 0.27z" stroke-width=".23"/>
    <text id="textDayNetUsage" x="5.2" y="29" fill="#4d4d4d" font-size="1.6px" text-align="center" style="font-variant-caps: normal; font-variant-east-asian: normal; font-variant-ligatures: normal; font-variant-numeric: normal; white-space: pre;">DayNetUsage</text>
    <text id="textActualNet" x="6.5" y="33.6" fill="#333333" font-size="1.6px" text-align="center" style="font-variant-caps: normal; font-variant-east-asian: normal; font-variant-ligatures: normal; font-variant-numeric: normal; font-weight: bold; white-space: pre;">ActualNet</text>
  </g>
  <g id="groupBatt">
    <g transform="matrix(0.010083, 0, 0, 0.008335, 27.65, 44.4)" style="">
      <path d="M319.089,27.221h-36.475V0h-95.27v27.221h-34.607c-22.517,0-40.829,18.317-40.829,40.832v362.946
      c0,22.51,18.317,40.83,40.829,40.83h166.352c22.524,0,40.832-18.32,40.832-40.83V68.052
      C359.921,45.538,341.613,27.221,319.089,27.221z M332.705,431.002c0,7.501-6.108,13.607-13.616,13.607H152.737
      c-7.501,0-13.608-6.095-13.608-13.607V68.052c0-7.501,6.107-13.611,13.608-13.611h166.352c7.508,0,13.616,6.109,13.616,13.611
      V431.002z M317.862,428.5H153.966v-59.719h163.896V428.5z M317.862,354.071H153.966v-59.716h163.896V354.071z M317.862,279.64
      H153.966v-59.72h163.896V279.64z"/>
    </g>
	<path id="SolarToBatt" d="m30 43v-26" stroke="#77eaea" stroke-width=".6"/>
	<line id="SolarToBatt-flow" x1="30" y1="17" x2="30" y2="43" style="stroke:red;stroke-width:0.2"/>
	<g transform="translate(30.5, 29.2)">
		<text id="textSolarToBatt" fill="#4d4d4d" font-size="1.1px" text-anchor="end" transform="rotate(90)" style="font-variant-caps: normal; font-variant-east-asian: normal; font-variant-ligatures: normal; font-variant-numeric: normal; white-space: pre;">SolarToBatt</text>
	</g>      
    <g fill="none">
      <path id="BattNet" d="m29 43c0 -8 -3 -11 -12.6 -11" stroke="#ffd000" stroke-width=".6"/>
      <path id="BattNet-flow" d="m29 43c0 -8 -3 -11 -12.6 -11" stroke="#f00" stroke-linecap="round" stroke-width=".2"/>
      <path id="BattHome" d="m31 43c0 -8 3 -11 12.6 -11" stroke="#ffd000" stroke-width=".6"/>
      <path id="BattHome-flow" d="m31 43c0 -8 3 -11 12.6 -11" stroke="#f00" stroke-linecap="round" stroke-width=".2"/>
    </g>
    <text id="textTotalCharge" x="30" y="51" fill="#333333" font-size="2px" text-align="center" text-anchor="middle" style="font-variant-caps: normal; font-variant-east-asian: normal; font-variant-ligatures: normal; font-variant-numeric: normal; font-weight: bold; white-space: pre;">80%</text>
    <text id="textActualBatt" x="30" y="54" fill="#333333" font-size="1.6px" text-align="center" text-anchor="middle" style="font-variant-caps: normal; font-variant-east-asian: normal; font-variant-ligatures: normal; font-variant-numeric: normal; font-weight: bold; white-space: pre;">ActualBatt</text>
    <text id="textActualBattNet" x="24.5" y="35" fill="#4d4d4d" font-size="1.1px" text-align="end" text-anchor="end" style="font-variant-caps: normal; font-variant-east-asian: normal; font-variant-ligatures: normal; font-variant-numeric: normal; white-space: pre;">ActualBattNet</text>
    <text id="textActualBattHome" x="35" y="35" fill="#4d4d4d" font-family="Arial" font-size="1.1px" stroke-linecap="round" stroke-width=".38" style="font-variant-caps: normal; font-variant-east-asian: normal; font-variant-ligatures: normal; font-variant-numeric: normal; white-space: pre;">ActualBattHome</text>
    <rect id="rectBatt" x="23" y="43" width="14" height="14" ry="7" fill="none" stroke="#90e090" stroke-linecap="round" stroke-width=".3"/>
  </g>
  <g id="groupHome" font-family="Arial" text-anchor="middle">
    <rect id="rectHome" x="43" y="22" width="14" height="14" ry="7" fill="none" stroke="#ff7bff" stroke-linecap="round" stroke-width=".3"/>
    <path id="pathIconHome" d="m49.7 27v-1.4h0.8v1.4h1v-1.9h0.6l-2-2.1-2 2.1h0.6v1.9z" stroke-width=".22"/>
    <path id="NetToHome" d="m17 30h26" stroke="#77eaea" stroke-width=".6"/>
    <path id="NetToHome-flow" d="m17 30h26" stroke="#f00" stroke-linecap="round" stroke-width=".2"/>
    <text id="textActualNetToHome" x="30" y="32" fill="#4d4d4d" font-size="1.1px" text-align="center" style="font-variant-caps: normal; font-variant-east-asian: normal; font-variant-ligatures: normal; font-variant-numeric: normal; white-space: pre;">ActualNetToHome</text>
    <text id="textHomeToday" x="50" y="29" fill="#333333" font-size="1.6px" text-align="center" style="font-variant-caps: normal; font-variant-east-asian: normal; font-variant-ligatures: normal; font-variant-numeric: normal; white-space: pre;">HomeToday</text>
    <text id="textHomeActual" x="50" y="32" fill="#333333" font-size="1.6px" text-align="center" style="font-variant-caps: normal; font-variant-east-asian: normal; font-variant-ligatures: normal; font-variant-numeric: normal; font-weight: bold; white-space: pre;">HomeActual</text>
  </g>
  <g id="groupSolar">
    <path id="pathIconSolar" d="m30 4v0.71l0.71-0.36-0.71-0.35m-0.2 1.2-0.49 0.49 0.75 0.25-0.26-0.74m-1.7 0.69 0.35 0.71 0.36-0.71h-0.71m1.6-1.9h-1.6v1.6c0.11 0.034 0.23 0.05 0.35 0.05 0.72 2e-3 1.3-0.58 1.3-1.3-2e-3 -0.12-0.02-0.24-0.054-0.35m1.4 4v-1.2h-0.6l1-1.8v1.2h0.6z" stroke-width=".2"/>
    <text id="textDayNetDeliv" x="10" y="31" fill="#ba88ff" font-family="Arial" font-size="1.6px" stroke-linecap="round" stroke-width=".38" text-align="center" text-anchor="middle" style="font-variant-caps: normal; font-variant-east-asian: normal; font-variant-ligatures: normal; font-variant-numeric: normal; white-space: pre;">DayNetDeliv</text>
    <text id="textActualSolarToHome" x="34" y="25" fill="#4d4d4d" font-family="Arial" font-size="1.1px" stroke-linecap="round" stroke-width=".38" style="font-variant-caps: normal; font-variant-east-asian: normal; font-variant-ligatures: normal; font-variant-numeric: normal; white-space: pre;">ActualSolarToHome</text>
    <g fill="none">
      <path id="SolarToHome" d="m31 17c0 8 3 11 12 11" stroke="#ffd000" stroke-width=".6"/>
      <path id="SolarToHome-flow" d="m31 17c0 8 3 11 12 11" stroke="#f00" stroke-linecap="round" stroke-width=".2"/>
      <path id="SolarToNet" d="m29 17c0 8-3 11-12 11" stroke="#ffd000" stroke-width=".6"/>
      <path id="SolarToNet-flow" d="m29 17c-0.011 8-3 11-12 11" stroke="#f00" stroke-linecap="round" stroke-width=".2"/>
    </g>
    <g font-family="Arial" stroke-linecap="round" stroke-width=".38">
      <text id="textDaySolar" x="30" y="10" fill="#333333" font-size="1.6px" text-align="center" text-anchor="middle" style="font-variant-caps: normal; font-variant-east-asian: normal; font-variant-ligatures: normal; font-variant-numeric: normal; white-space: pre;">DaySolar</text>
      <text id="textActualSolar" x="30" y="13" fill="#333333" font-size="1.6px" text-align="center" text-anchor="middle" style="font-variant-caps: normal; font-variant-east-asian: normal; font-variant-ligatures: normal; font-variant-numeric: normal; font-weight: bold; white-space: pre;">ActualSolar</text>
      <text id="textActualSolarToNet" x="26" y="25" fill="#4d4d4d" font-size="1.1px" text-align="end" text-anchor="end" style="font-variant-caps: normal; font-variant-east-asian: normal; font-variant-ligatures: normal; font-variant-numeric: normal; white-space: pre;">ActualSolarToNet</text>
    </g>
    <rect id="rectSolar" x="23" y="3" width="14" height="14" ry="7" fill="none" stroke="#ffd000" stroke-linecap="round" stroke-width=".3"/>
  </g>
  <g id="groupGas">
    <rect id="rectGas" x="43" y="3" width="14" height="14" ry="7" fill="none" stroke="#0ff" stroke-linecap="round" stroke-width=".3"/>
    <path id="pathIconGas" d="m51 7.8c-0.053-0.067-0.12-0.12-0.18-0.18-0.15-0.13-0.33-0.23-0.47-0.37-0.34-0.32-0.42-0.86-0.2-1.3-0.22 0.051-0.41 0.17-0.57 0.29-0.59 0.46-0.82 1.3-0.55 2 0.0092 0.022 0.018 0.044 0.018 0.073 0 0.049-0.034 0.093-0.08 0.11-0.053 0.022-0.11 0.0089-0.15-0.027-0.014-0.011-0.023-0.022-0.032-0.038-0.26-0.32-0.3-0.77-0.13-1.1-0.38 0.3-0.59 0.81-0.56 1.3 0.014 0.11 0.027 0.22 0.066 0.33 0.032 0.13 0.094 0.27 0.16 0.38 0.25 0.38 0.67 0.66 1.1 0.72 0.49 0.06 1-0.027 1.4-0.36 0.42-0.37 0.56-0.96 0.35-1.5l-0.03-0.058c-0.048-0.1-0.18-0.28-0.18-0.28m-0.72 1.4c-0.064 0.053-0.17 0.11-0.25 0.13-0.26 0.089-0.51-0.036-0.66-0.18 0.27-0.062 0.43-0.26 0.48-0.46 0.039-0.18-0.034-0.32-0.064-0.5-0.027-0.16-0.023-0.3 0.039-0.46 0.043 0.084 0.089 0.17 0.14 0.24 0.18 0.22 0.45 0.32 0.51 0.62 0.0092 0.031 0.014 0.062 0.014 0.096 0.0067 0.18-0.075 0.38-0.21 0.5z" stroke-width=".23"/>
    <text id="textDayGas" x="50" y="13" fill="#333333" font-family="Arial" font-size="1.6px" stroke-linecap="round" stroke-width=".38" text-align="center" text-anchor="middle" style="font-variant-caps: normal; font-variant-east-asian: normal; font-variant-ligatures: normal; font-variant-numeric: normal; white-space: pre; font-weight: bold;">DayGas</text>
    <path id="GasToHome" d="m50 21.85v-4.7" fill="#f0f" stroke="#4d4d4d" stroke-width=".6"/>
  </g>
 </svg>
</div>

<script type="text/javascript" charset="utf-8">
// ---------------------------------------------------------------------------------------------------------------------------
// Start of customizable parameters
// ---------------------------------------------------------------------------------------------------------------------------
let idP1Meter = 1768;		// Change this value to be your ID for the Electricity Meter (P1)
let idGas = 1773;			// Change this value to be your ID for the Gas meter. Set to -1 when not used.
let idSolar = 8023;			// Change this value to be your ID for your Solar Power. Set to -1 when not used.
let idBattSetpoint = 9448;		// Change this value to be your ID for your Battery Watt. Set to -1 when not used.
let idBattSoc = 9454;		// Change this value to be your ID for your Battery SOC. Set to -1 when not used.
let sLocales = 'nl-NL';		// Update your locales. For more information see: https://www.w3schools.com/jsref/jsref_tolocalestring.asp
// ---------------------------------------------------------------------------------------------------------------------------
// End of customizable parameters
// ---------------------------------------------------------------------------------------------------------------------------


function updatePower() {
	let fDayNetUsage, fDayNetDeliv, fDaySolar, fDayHomeUsage,
		fActualNet, fActualSolar, fActualHomeUsage,
		fActualNetToHome, fActualSolarToNet, fActualSolarToHome,
		fDayGasUsage;

	let getPower = $.getJSON('/json.htm?type=command&param=getdevices&rid=' + idP1Meter, function(data){
			fDayNetUsage = parseFloat(data["result"][0]["CounterToday"].slice(0, -4).replace(',','.'));
			fDayNetDeliv = parseFloat(data["result"][0]["CounterDelivToday"].slice(0, -4).replace(',','.'));
			let fActualNetUsage = parseFloat(data["result"][0]["Usage"].slice(0, -5).replace(',','.'));
			let fActualNetDeliv = parseFloat(data["result"][0]["UsageDeliv"].slice(0, -5).replace(',','.'));
			fActualNet = fActualNetUsage - fActualNetDeliv;
		});

	let getSolar = $.getJSON('/json.htm?type=command&param=getdevices&rid=' + idSolar, function(data){
			fDaySolar = parseFloat(data["result"][0]["CounterToday"].slice(0, -4).replace(',','.'));
			fActualSolar = parseFloat(data["result"][0]["Usage"].slice(0, -5).replace(',','.'));
		});

	let getBattSetpoint = $.getJSON('/json.htm?type=command&param=getdevices&rid=' + idBattSetpoint, function(data){
			fActualBattWatt = data["result"][0]["Data"];
		});
	let getBattSoc = $.getJSON('/json.htm?type=command&param=getdevices&rid=' + idBattSoc, function(data){
			txtBattSoc = data["result"][0]["Data"];
		});

	function GetAnim(fPower, isReverse = false) {
			let fSec = 5 - fPower / 2000;
			fSec = (fSec<0.5) ? 0.5 : fSec;
			let ret = 'flow '+fSec.toFixed(1)+'s linear infinite';
			if (isReverse == true) {
				ret += " reverse";
			}
			return ret;
	}

	function UpdateScreen() {
		//Update Page
	
		//for debugging purposes
		//fActualNet = -1000;
		//fActualSolar = 2200;
		//fActualBattWatt = -500;

		document.getElementById("textDaySolar").textContent = fDaySolar.toLocaleString(sLocales) + ' kWh';
		document.getElementById("textActualSolar").textContent = fActualSolar.toLocaleString(sLocales) + ' Watt';
		document.getElementById("textTotalCharge").textContent = txtBattSoc;
		document.getElementById("textActualBatt").textContent = fActualBattWatt.toLocaleString(sLocales) + ' Watt';

		// Home usage: Calculated
		fDayHomeUsage = fDayNetUsage + fDaySolar - fDayNetDeliv;
		fActualHomeUsage = fActualSolar;
		if (fActualNet > 0) {
			fActualHomeUsage += fActualNet;
		}

		let BattNeededFromGrid = 0; //negative if batt is discharging
		let SolarToBatt = 0;
		let BattToHome = 0;

		if (fActualNet>0) {
			fActualNetToHome = fActualNet;
			fActualSolarToNet = 0;
			fActualSolarToHome = fActualSolar;
		} else {
			fActualNetToHome = 0;
			fActualSolarToNet = (fActualNet > 0) ? fActualNet : 0;
			if (fActualNet > 0) {
				fActualSolarToHome = fActualSolar - Math.abs(fActualNet);
			}
			else {
				fActualSolarToHome = fActualSolar;
				if (fActualBattWatt < 0) {
					let rest = (Math.abs(fActualNet) - Math.abs(fActualBattWatt));
					if (rest > 0) {
						fActualSolarToHome -= rest;
						fActualHomeUsage -= rest;
						fActualSolarToNet = rest;
					}
				} else {
					if (fActualBattWatt > 0) {
						let rest = fActualSolarToHome - (Math.abs(fActualNet) + Math.abs(fActualBattWatt));
						if (rest > 0) {
							fActualSolarToHome -= rest;
							fActualHomeUsage -= rest;
							fActualSolarToNet = rest;
						}
					}
				}
			}
		}

		//Update battery stats
		if (idBattSetpoint != -1) {
			if ((fActualBattWatt > 0) && (fActualSolar > 0)) {
				//some solar (if not all) is also charging the battery
				SolarToBatt = Math.min(fActualSolar, fActualBattWatt);
				fActualSolarToHome -= SolarToBatt;
				BattNeededFromGrid = fActualBattWatt - SolarToBatt;
				fActualHomeUsage -= SolarToBatt + BattNeededFromGrid;
				fActualNetToHome -= BattNeededFromGrid;
			} else if ((fActualBattWatt > 0) && (fActualSolar == 0)) {
				//we need all power from the grid
				BattNeededFromGrid = fActualBattWatt;
				if (1==1) {//fActualBattWatt < fActualNet) {
					fActualNetToHome -= BattNeededFromGrid;
					fActualHomeUsage -= BattNeededFromGrid;
				}
			}

			if (fActualBattWatt < 0) {
				//we are discharging
				if (fActualNet >= 0) {
					//we discharge all to home
					BattToHome = Math.abs(fActualBattWatt);
				} else {
					BattToHome = Math.max(Math.abs(fActualBattWatt) - Math.abs(fActualNet), 0);
				}
			}
			fActualHomeUsage += BattToHome;
			
			if (SolarToBatt > 0) {
				document.getElementById('SolarToBatt-flow').style.display = '';
				document.getElementById('SolarToBatt-flow').style.animation = GetAnim(SolarToBatt);
				document.getElementById("textSolarToBatt").textContent = SolarToBatt.toLocaleString(sLocales) + ' Watt';
			} else {
				document.getElementById('SolarToBatt-flow').style.display = 'none';
				document.getElementById("textSolarToBatt").textContent = '';
			}
			
			
			if (fActualBattWatt - SolarToBatt == 0) {
				document.getElementById('BattNet-flow').style.display = 'none';
				document.getElementById("textActualBattNet").textContent = '';
			} else {
				if (BattNeededFromGrid == 0) {
					if (fActualNet < 0) {
						document.getElementById('BattNet-flow').style.display = '';
						document.getElementById('BattNet-flow').style.animation = GetAnim(Math.abs(fActualNet));
						let battToNet = Math.abs(fActualNet);
						if (fActualBattWatt < 0) {
							 battToNet = Math.min(battToNet,Math.abs(fActualBattWatt));
						}
						document.getElementById("textActualBattNet").textContent = battToNet.toLocaleString(sLocales) + ' Watt';
					} else {
						document.getElementById('BattNet-flow').style.display = 'none';
						document.getElementById("textActualBattNet").textContent = '';
					}
				} else {
					if (fActualBattWatt > 0) {
						//charging battery
						document.getElementById('BattNet-flow').style.display = '';
						document.getElementById('BattNet-flow').style.animation = GetAnim(BattNeededFromGrid, true);
						document.getElementById("textActualBattNet").textContent = BattNeededFromGrid.toLocaleString(sLocales) + ' Watt';
					}
				}
			}
			if (BattToHome == 0) {
				document.getElementById('BattHome-flow').style.display = 'none';
				document.getElementById("textActualBattHome").textContent = '';
			} else {
				document.getElementById('BattHome-flow').style.display = '';
						document.getElementById('BattHome-flow').style.animation = GetAnim(BattToHome);
				document.getElementById("textActualBattHome").textContent = BattToHome.toLocaleString(sLocales) + ' Watt';;
			}
		}
		
		if (BattToHome > 0) {
			//if batery is discharging to Home, this means we are using all solar Power
			//fActualSolarToNet = 0;
			//fActualSolarToHome = fActualSolar;
			//fActualHomeUsage += BattToHome;
		}
		

		document.getElementById("textHomeToday").textContent = fDayHomeUsage.toLocaleString(sLocales) + ' kWh';
		document.getElementById("textHomeActual").textContent = fActualHomeUsage.toLocaleString(sLocales) + ' Watt';

		document.getElementById("textDayNetDeliv").textContent = '⇦ ' + fDayNetDeliv.toLocaleString(sLocales) + ' kWh';
		document.getElementById("textDayNetUsage").textContent = '⇨ ' + fDayNetUsage.toLocaleString(sLocales) + ' kWh';
		
		document.getElementById("textActualNet").textContent = fActualNet.toLocaleString(sLocales) + ' Watt';
		
		if (fActualNetToHome==0) {
			document.getElementById('NetToHome-flow').style.display = 'none';
			document.getElementById("textActualNetToHome").textContent = '';
		} else {
			document.getElementById('NetToHome-flow').style.display = '';
			document.getElementById('NetToHome-flow').style.animation = GetAnim(fActualNetToHome);	
			document.getElementById("textActualNetToHome").textContent = fActualNetToHome.toLocaleString(sLocales) + ' Watt';
		}

		if (fActualSolarToNet==0) {
			document.getElementById('SolarToNet-flow').style.display = 'none';
			document.getElementById("textActualSolarToNet").textContent = '';
		} else {
			document.getElementById('SolarToNet-flow').style.display = '';
			document.getElementById('SolarToNet-flow').style.animation = GetAnim(fActualSolarToNet);	
			document.getElementById("textActualSolarToNet").textContent = fActualSolarToNet.toLocaleString(sLocales) + ' Watt';
		}

		if (fActualSolarToHome==0) {
			document.getElementById('SolarToHome-flow').style.display = 'none';
			document.getElementById("textActualSolarToHome").textContent = '';
		} else {
			document.getElementById('SolarToHome-flow').style.display = '';
			document.getElementById('SolarToHome-flow').style.animation = GetAnim(fActualSolarToHome);
			document.getElementById("textActualSolarToHome").textContent = fActualSolarToHome.toLocaleString(sLocales) + ' Watt';
		}
	}
	
	// Update Net/Solar
	if (idSolar>-1) {	
		$.when(getPower, getSolar, getBattSetpoint, getBattSoc).done(UpdateScreen);
	} else {
		fDaySolar = 0;
		fActualSolar = 0;
		$.when(getPower).done(UpdateScreen);
	}
	
	// Update Gas
	if (idGas>-1) {
		$.getJSON('/json.htm?type=command&param=getdevices&rid=' + idGas, function(data){
			fDayGasUsage = parseFloat(data["result"][0]["CounterToday"].slice(0, -3).replace(',','.'));
			document.getElementById("textDayGas").textContent = fDayGasUsage.toLocaleString(sLocales) + ' m3';
		});
	}

}

$(document).ready( function() {
	if (idGas==-1) { $('#groupGas').hide();	}
	if (idSolar==-1) { $('#groupSolar').hide();	}
	updatePower();
	setInterval(function(){ updatePower(); }, 5000);	
});
</script>